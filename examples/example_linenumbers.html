<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SquibView Line Numbers Example</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><circle cx='16' cy='16' r='14' fill='%23f57c00' stroke='%23000' stroke-width='1'/><path d='M2 16h28M16 2a14 14 0 0114 14 14 14 0 01-14 14 14 14 0 01-14-14A14 14 0 0116 2zm0 0v28M9 16a7 7 0 0014 0 7 7 0 00-14 0z' fill='none' stroke='%23000' stroke-width='1'/></svg>">

  <!-- SquibView CSS -->
  <link rel="stylesheet" href="../dist/squibview.min.css">

  <!-- External dependencies for advanced features -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/default.min.css">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      height: 100vh;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 8px;
    }

    .controls button {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .controls button:hover {
      background: #f0f0f0;
    }

    .controls button.active {
      background: #2a57d3;
      color: white;
    }

    .editor-container {
      display: flex;
      gap: 20px;
      flex: 1;
      min-height: 0;
    }

    #editor1, #editor2 {
      flex: 1;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
    }

    .editor-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .editor-title {
      padding: 10px;
      background: #f0f0f0;
      border-bottom: 1px solid #ddd;
      font-weight: bold;
    }

    /* Custom theme for dark mode example */
    #editor2 {
      --squibview-background-color: #1a1a1a;
      --squibview-input-background-color: #1a1a1a;
      --squibview-output-background-color: #1a1a1a;
      --squibview-primary-color: #4a9eff;
      --squibview-border-color: #444;
      --squibview-gutter-bg: #2d2d2d;
      --squibview-gutter-fg: #888;
      --squibview-gutter-border: #444;
    }

    #editor2 .squibview-input {
      color: #e0e0e0;
    }

    #editor2 .squibview-output {
      color: #e0e0e0;
    }
  </style>
</head>
<body>
  <h1>SquibView Line Numbers Example</h1>
  
  <div class="controls">
    <button id="toggleLineNumbers1">Toggle Line Numbers (Editor 1)</button>
    <button id="toggleLineNumbers2">Toggle Line Numbers (Editor 2)</button>
    <button id="changeStartNumber">Change Start Number to 100</button>
    <button id="addLongContent">Add Long Content</button>
  </div>

  <div class="editor-container">
    <div class="editor-wrapper">
      <div class="editor-title">Editor 1: Line Numbers Enabled</div>
      <div id="editor1"></div>
    </div>
    
    <div class="editor-wrapper">
      <div class="editor-title">Editor 2: Dark Theme with Line Numbers</div>
      <div id="editor2"></div>
    </div>
  </div>

  <script type="module">
    // Import SquibView ESM build
    import SquibView from '../dist/squibview.esm.min.js';
    
    // Load highlight.js for syntax highlighting
    const loadHighlightJs = async () => {
      await new Promise((resolve) => {
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js';
        script.onload = resolve;
        document.head.appendChild(script);
      });
    };

    await loadHighlightJs();

    // Sample content to demonstrate line numbers
    const sampleContent = `# Line Numbers Demo

This is a demonstration of the line numbers feature in SquibView.

## Features

- Line numbers are displayed on the left side
- Numbers update automatically as you type
- Works with wrapped lines (try resizing the window!)
- Scroll synchronization between gutter and content

## Code Example

Here's a code block to test syntax highlighting:

\`\`\`javascript
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

// This is a very long comment that will wrap to multiple lines when the editor is narrow enough. It demonstrates how line numbers handle wrapped content correctly.
console.log(fibonacci(10));
\`\`\`

## Long Lines

This is a very long line that will definitely wrap when the editor width is reduced. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.

## Lists

1. First item
2. Second item with a very long description that might wrap to multiple lines depending on the width of the editor
3. Third item
   - Nested item
   - Another nested item with long text that demonstrates wrapping behavior

## Testing Empty Lines

Line before empty lines.


Multiple empty lines above.

## The End

Try editing this content and watch how the line numbers update!`;

    // Initialize editor 1 with line numbers enabled
    const editor1 = new SquibView('#editor1', {
      initialContent: sampleContent,
      showLineNumbers: true,
      initialView: 'split'
    });

    // Initialize editor 2 with line numbers and different settings
    const editor2 = new SquibView('#editor2', {
      initialContent: `# Dark Theme Example

This editor demonstrates line numbers with a dark theme.

## Custom Line Number Start

You can set a custom starting line number:

\`\`\`python
def hello_world():
    print("Hello, World!")
    
def main():
    hello_world()
    
if __name__ == "__main__":
    main()
\`\`\`

The line numbers can start from any value you choose.`,
      showLineNumbers: true,
      lineNumberStart: 1,
      lineNumberMinDigits: 3,
      initialView: 'src'
    });

    // Toggle line numbers for editor 1
    document.getElementById('toggleLineNumbers1').addEventListener('click', () => {
      const currentState = editor1.getLineNumbers();
      editor1.setLineNumbers(!currentState);
      document.getElementById('toggleLineNumbers1').textContent = 
        `Toggle Line Numbers (Editor 1) - Currently: ${!currentState ? 'ON' : 'OFF'}`;
    });

    // Toggle line numbers for editor 2
    document.getElementById('toggleLineNumbers2').addEventListener('click', () => {
      const currentState = editor2.getLineNumbers();
      editor2.setLineNumbers(!currentState);
      document.getElementById('toggleLineNumbers2').textContent = 
        `Toggle Line Numbers (Editor 2) - Currently: ${!currentState ? 'ON' : 'OFF'}`;
    });

    // Change start number
    document.getElementById('changeStartNumber').addEventListener('click', () => {
      editor1.setLineNumberStart(100);
      editor2.setLineNumberStart(42);
    });

    // Add long content to test performance
    document.getElementById('addLongContent').addEventListener('click', () => {
      let longContent = editor1.getContent() + '\n\n## Performance Test\n\n';
      for (let i = 1; i <= 100; i++) {
        longContent += `Line ${i}: This is a test line with some content. Lorem ipsum dolor sit amet.\n`;
      }
      editor1.setContent(longContent, 'md');
    });

    // Update button text to show current state
    document.getElementById('toggleLineNumbers1').textContent = 
      'Toggle Line Numbers (Editor 1) - Currently: ON';
    document.getElementById('toggleLineNumbers2').textContent = 
      'Toggle Line Numbers (Editor 2) - Currently: ON';
  </script>
</body>
</html>